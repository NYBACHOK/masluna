import "fonts/GeosansLight.ttf";

import { Theme } from "base/theme.slint";
import { AppLogic } from "logic/desktop-window-logic.slint";
import { VerticalBox, HorizontalBox, GroupBox, TextEdit, Button } from "std-widgets.slint";

export { AppLogic }

export component App inherits Window {
    title: "WASM Runner";

    in-out property <string> file_path;
    in-out property <string> preview_content: "Select a file to see preview...";
    in-out property <string> execution_output: "Output will appear here after execution.";

    preferred-width: Theme.default-width;
    preferred-height: Theme.default-height;
    default-font-size: Theme.default-font-size;
    default-font-weight: Theme.normal-font-weight;
    default-font-family: Theme.default-font-family;
    background: Theme.base-background;

    VerticalBox {
            spacing: 15px;
            padding: 20px;

            // --- Top Section: File Selection ---
            HorizontalBox {
                spacing: 10px;
                Button {
                    text: "ðŸ“‚ Select WASM File";
                    clicked => { AppLogic.file_pick() }
                }
                Text {
                    text: root.file_path;
                    vertical-alignment: center;
                    color: Colors.black;
                    overflow: elide;
                }
            }

            // --- Middle Section: Preview ---
            GroupBox {
                title: "File Preview (Text Snippet)";
                TextEdit {
                    text: root.preview_content;
                    read-only: true;
                    height: 120px;
                }
            }

            // --- Action Section ---
            Button {
                text: "Start Execution";
                primary: true;
                enabled: root.file_path != "No file selected";
                clicked => { AppLogic.run_wasm() }
            }

            // --- Bottom Section: Output ---
            GroupBox {
                title: "Execution Output";
                TextEdit {
                    text: root.execution_output;
                    read-only: true;
                }
            }
        }
}
